#!/bin/bash
# Copyright Â© 2016 Martin Ueding <dev@martin-ueding.de>

set -e
set -u

dest="$HOME/archived-logs/"

for arg
do
    run="$PWD/${arg%/}"
    basename="${run##*/}"
    dirname="${run%/*}"

    echo $arg

    pushd "$run" > /dev/null
    rm -f ./*.lime hmc core.*
    popd > /dev/null

    pushd "$dirname" > /dev/null
    archive="$basename.tar.gz" 
    tar -czf "$archive" "$basename"
    mv "$archive" "$dest"
    popd > /dev/null

    rm -rf "$run"
done
